os:
    - osx
osx_image: xcode6.4

language: cpp
compiler:
    - clang

before_install:
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then
             brew update &> /dev/null
          && travis_wait brew install --force-bottle conan openssl qbs
          && brew link --force openssl
          && travis_wait brew install --build-from-source python@2 --with-brewed-openssl
      ; fi
    - pip2 install --upgrade pip setuptools
    - pip2 install --upgrade hashlib
    - pip2 install --upgrade pyOpenSSL
    - /usr/local/Cellar/conan/1.1.1/libexec/bin/python -c "import ssl; print(ssl.OPENSSL_VERSION)" || true
    - /usr/bin/python -c "import ssl; print(ssl.OPENSSL_VERSION)" || true
    - /usr/local/bin/python2 -c "import ssl; print(ssl.OPENSSL_VERSION)" || true

install:
    - qbs setup-qt --detect
    - qbs setup-toolchains --detect
    - conan config install https://vuo.org/sites/default/files/conan-macos.zip
    - conan user

script:
    - conan create . vuo/stable
      && conan upload --remote vuo --all --confirm json-c/*
